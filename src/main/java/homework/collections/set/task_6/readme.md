Обработка потока событий из распределенных систем (Distributed Event Stream Processing)

Представь, что ты разрабатываешь систему обработки событий,
поступающих из различных распределенных источников (серверы приложений, датчики, микросервисы и т.д.).

Твоя задача - объединить эти события в единый поток, сохраняя порядок поступления событий
(с учетом возможной задержки и рассинхронизации времени между источниками),
а также обеспечивая дедупликацию (исключение дубликатов).

Требования:
- просмотри код, не сильно заморачивайся, тут уже потоки (для имитации поступления различных событий)
- добавь код в класс EventAggregator:
- поле LinkedHashSet<Event> events = new LinkedHashSet<>() для хранения событий.
*Event – класс с атрибутами: timestamp, source, id, data.*
- реализуй метод processEvent(Event event): добавляет событие в LinkedHashSet.
*LinkedHashSet автоматически исключит дубликаты, и сохранит порядок поступления событий.*
- добавь событие в events
- выведи сообщение о добавлении или игнорировании дубликата (метод add() вернет false, если элемент не добавится)
- реализуй метод getProcessedEvents(): возвращает список событий в порядке их поступления, без дубликатов:
- внутри метода создай новый LinkedHashSet<Event> aggregatedEvents для хранения упорядоченных событий
- итерируйся по LinkedHashSet events, начиная с самого старого события.
- для каждого события проверь, выполняется ли условие **event.timestamp < currentTime - maxOutOfOrderMillis***
- если условие выполняется, добавь событие в aggregatedEvents и удали его из events
- если условие не выполняется, останови итерацию (потому что все остальные события в events еще не могут быть
упорядочены)
- верни aggregatedEvents
- реализуй метод getEventCount: возвращает количество событий в агрегаторе
- проверь работу программы

Доп информация о реализации:

1) Класс Event:
    - timestamp: Время создания события (в миллисекундах, long)
      *Это ключевой атрибут для упорядочивания событий*
    - source: Идентификатор источника события (String)
    - id: Уникальный идентификатор события (String, UUID). Используется для дедупликации. Генерируется источником
      события.
    - data: Полезная нагрузка события (String или более сложный объект).

2) Класс EventAggregator:
    - LinkedHashSet<Event>: Для хранения объединенных событий. Порядок важен, и дубликаты исключаются (благодаря
      использованию id при сравнении).
    - long maxOutOfOrderMillis: Максимальная допустимая задержка между событиями (в миллисекундах). Используется для
      определения, когда можно считать, что все события за определенный период времени уже поступили.
    - processEvent(Event event):
        - Добавляет событие в LinkedHashSet. Если событие с таким id уже есть, новое событие игнорируется (гарантия
          дедупликации).
    - getAggregatedEvents(long currentTime):
        - Возвращает список агрегированных событий, которые уже могут быть упорядочены. События могут быть упорядочены,
          если их timestamp меньше, чем currentTime - maxOutOfOrderMillis.
        - event.timestamp < currentTime - maxOutOfOrderMillis: это условие определяет, можно ли считать,
          что событие уже “упорядочено” и готово к дальнейшей обработке.
          То есть, прошло достаточно времени с момента его создания, чтобы мы были уверены,
          что более ранние события из других источников уже поступили.
        - maxOutOfOrderMillis задает “окно”, в течение которого мы ожидаем события